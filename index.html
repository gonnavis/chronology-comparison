<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <meta name="viewport" id="viewport" content="width=device-width, initial-scale=1">
    <title>chronology</title>
    <style>
        #control{
            position: fixed;
            top: 0;
            left: 0;
            background-color: #CCCCCC
        }
    </style>
</head>
<body onload="main();">
    <div id="control">
        历史年表对照：
        <select id="top_select">
            <option value ="china" selected>中华文明</option>
            <option value="india">印度河文明</option>
            <option value="egypt">埃及尼罗河流域文明</option>
            <option value="greece">希腊爱琴海文明</option>
            <option value="mesopotamia">两河流域文明</option>
            <option value ="japan">日本</option>
            <option value="russia">俄国</option>
            <option value="artist">世界艺术史</option>
        </select>
        VS
        <select id="bottom_select">
            <option value ="china">中华文明</option>
            <option value="india">印度河文明</option>
            <option value="egypt">埃及尼罗河流域文明</option>
            <option value="greece">希腊爱琴海文明</option>
            <option value="mesopotamia">两河流域文明</option>
            <option value ="japan" selected>日本</option>
            <option value="russia">俄国</option>
            <option value="artist">世界艺术史</option>
        </select>
        author: <a href="http://weibo.com/u/2637623441" target="_blank">@谢帅shawn</a>
    </div>
</body>
<script src="./js/graph.js"></script>
<script>
    /**
     * Created by shawn on 2014/9/8.
     */
    let graph = new Graph();

    let top_select = document.getElementById("top_select");
    let bottom_select = document.getElementById("bottom_select");

    function main(){
        refresh();

        top_select.onchange = refresh;
        bottom_select.onchange = refresh;
    }

    function refresh() {
        let top = top_select.value.toLowerCase();
        let bottom = bottom_select.value.toLowerCase();

        Promise.all([
            fetch('./data/' + top + '/period.json').then(response => response.json()),
            fetch('./data/' + top + '/event.json').then(response => response.json()),
            fetch('./data/' + bottom + '/period.json').then(response => response.json()),
            fetch('./data/' + bottom + '/event.json').then(response => response.json()),
        ])
        .then(jsons => jsons.map(json => json.data))
        .then(data => graph.render(data))
        .catch(e => console.warn(e));
    }

</script>
</html>